[gd_resource type="ShaderMaterial" load_steps=4 format=2]

[sub_resource type="Shader" id=1]
code = "shader_type spatial;

uniform sampler2D erbetta;
uniform vec4 sabbia :hint_color =vec4(0.90,0.93,0.62,1.0);
uniform vec4 erba :hint_color =vec4(0.56,1.0,0.53,1.0);
uniform vec4 roccia :hint_color = vec4( 0.2,0.2,0.2, 1.0);
varying flat vec3 lati;

vec3 interpColore(vec4 a, vec4 b, float h){
	float cr = a.r +(b.r- a.r) *h;
	float cb = a.b +(b.b- a.b) *h;
	float cg = a.g +(b.g- a.g) *h;
	return vec3(cr, cg,cb);
}

void vertex(){
	lati = vec3(sabbia.r, sabbia.g, sabbia.b);
	if(VERTEX.y>-1.0){
		lati = interpColore(sabbia,erba, clamp((VERTEX.y-5.0)/3.0,0.0,1.0));
	}
	else{
			lati.g *= texture(erbetta, VERTEX.xz).r;
	}
	if(abs(BINORMAL.y)<0.8 || abs(TANGENT.y) <0.8){
		lati = interpColore(vec4(lati.r,lati.g,lati.b,1.0), roccia, clamp((abs(BINORMAL.y)+0.6)/1.2,0.0,1.0));
		lati.g *= texture(erbetta, VERTEX.xz).r*2.0;
	}
}

void fragment(){

	ALBEDO = lati;
}"

[sub_resource type="OpenSimplexNoise" id=2]
period = 2.7
persistence = 0.0

[sub_resource type="NoiseTexture" id=3]
width = 2048
height = 2048
as_normalmap = true
bump_strength = 0.4
noise = SubResource( 2 )

[resource]
shader = SubResource( 1 )
shader_param/sabbia = Color( 0.0156863, 1, 0, 1 )
shader_param/erba = Color( 1, 1, 1, 1 )
shader_param/roccia = Color( 0.356863, 0.321569, 0.133333, 1 )
shader_param/erbetta = SubResource( 3 )
